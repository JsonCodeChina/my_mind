# ccnews 增量更新指南

## 🎯 核心理念

**只关注变化，突出新内容**

- 跳过未变化的官方内容（版本号、文档）
- 重点关注社区每日核心动态
- 追踪新文章，自动检测发布时间
- 精简输出，快速获取关键信息

## 📊 数据分类与更新策略

### 1. 官方内容（低频更新）

#### 官方文档
- **检查频率**：每次运行对比 baseline
- **变化检测**：对比版本号、最后更新日期
- **输出策略**：仅在有变化时显示

#### 更新日志
- **检查频率**：每次运行
- **变化检测**：对比最新版本号
- **输出策略**：仅显示新版本的更新内容

### 2. 社区内容（中频更新）

#### 社区文档站
- **检查频率**：每次运行
- **变化检测**：
  1. 爬取所有文章列表
  2. 提取文章 URL、标题、最后更新时间
  3. 对比 cache/articles.json
  4. 标记新文章和更新文章
- **输出策略**：
  - 🆕 **新文章**：完整显示（标题、摘要、发布日期、链接）
  - 🔄 **更新文章**：显示更新内容（如果能检测到）
  - 📚 **未变化文章**：仅列入目录，不显示详情

#### 社区最佳实践
- **检查频率**：每次运行
- **变化检测**：对比文章哈希值或更新时间
- **输出策略**：仅显示新增或更新的教程

### 3. 社区讨论（高频更新）

#### GitHub Issues
- **检查频率**：每次运行
- **时间范围**：lookbackDays: 2（最近2天）
- **变化检测**：
  1. 按创建时间过滤
  2. 提取新 Issue、新评论、关闭的 Issue
  3. 对比 cache/community.json
- **输出策略**：
  - 🔴 **新 Issue**：完整显示（标题、描述摘要、链接、创建时间）
  - 💬 **热门讨论**：显示高互动 Issue（评论数 > 5）
  - ✅ **已解决**：显示最近关闭的重要 Issue

#### Hacker News
- **检查频率**：每次运行
- **时间范围**：lookbackDays: 7（最近7天）
- **变化检测**：搜索关键词，按时间排序
- **输出策略**：
  - 显示新讨论线程（标题、摘要、链接、评论数、发布时间）
  - 仅保留评论数 > 10 的热门讨论

#### Reddit
- **检查频率**：每次运行
- **时间范围**：lookbackDays: 7（最近7天）
- **变化检测**：搜索 r/ClaudeAI 相关帖子
- **输出策略**：
  - 显示新帖子（标题、摘要、链接、投票数、发布时间）
  - 仅保留投票数 > 20 的热门帖子

## 🗄️ 缓存数据结构

### cache/articles.json
```json
{
  "lastUpdate": "2025-10-13",
  "articles": [
    {
      "url": "https://cc.deeptoai.com/docs/en/best-practices/...",
      "title": "文章标题",
      "publishDate": "2025-10-10",
      "lastModified": "2025-10-12",
      "contentHash": "abc123...",
      "firstSeenDate": "2025-10-12",
      "category": "best-practices",
      "language": "en"
    }
  ]
}
```

### cache/versions.json
```json
{
  "lastUpdate": "2025-10-13",
  "claudeCodeVersion": "2.0.14",
  "lastVersionReleaseDate": "2025-10-11",
  "previousVersion": "2.0.13",
  "previousVersionReleaseDate": "2025-10-09",
  "officialDocsLastModified": "2025-10-11"
}
```

### cache/community.json
```json
{
  "lastUpdate": "2025-10-13",
  "githubIssues": [
    {
      "number": 3477,
      "title": "Issue 标题",
      "createdAt": "2025-10-12",
      "updatedAt": "2025-10-13",
      "state": "open",
      "comments": 15,
      "firstSeenDate": "2025-10-12"
    }
  ],
  "hackerNewsThreads": [
    {
      "id": "39847362",
      "title": "讨论标题",
      "url": "https://news.ycombinator.com/item?id=39847362",
      "createdAt": "2025-10-12",
      "points": 234,
      "comments": 89,
      "firstSeenDate": "2025-10-12"
    }
  ],
  "redditPosts": [
    {
      "id": "xyz123",
      "title": "帖子标题",
      "url": "https://reddit.com/...",
      "createdAt": "2025-10-11",
      "upvotes": 67,
      "comments": 23,
      "firstSeenDate": "2025-10-11"
    }
  ]
}
```

## 📋 输出格式优化

### 每日报告结构

```
# Claude Code 每日动态 - 2025-10-13

## 🎯 今日要点（3句话）
- 官方更新：[有/无] 新版本
- 社区文章：X 篇新文章
- 社区讨论：X 个热门话题

---

## 🆕 官方更新（仅在有变化时显示）

### v2.0.15 发布（2025-10-13）
- 功能1：说明
- 功能2：说明
- 功能3：说明

[查看完整更新日志](链接)

---

## 📚 新文章（按发布时间排序）

### 1. 文章标题 🆕
- **发布时间**：2025-10-13
- **分类**：最佳实践
- **摘要**：这篇文章主要讲了...（AI 生成的 2-3 句话摘要）
- **链接**：[阅读全文](URL)

### 2. 文章标题 🔄 更新
- **更新时间**：2025-10-13
- **首次发布**：2025-10-01
- **更新内容**：新增了...部分
- **链接**：[阅读全文](URL)

---

## 🔥 社区核心动态（最近24小时）

### GitHub Issues

#### 🔴 新 Issue
- **#3500** - Issue 标题（2025-10-13）
  - 问题摘要：...
  - 影响范围：...
  - 状态：待解决
  - [查看详情](链接)

#### 💬 热门讨论
- **#3477** - 配置文件膨胀问题（15 条评论）
  - 最新进展：已在 v1.0.53 修复
  - [查看详情](链接)

#### ✅ 已解决
- **#3465** - Bug 修复（2025-10-12 关闭）
  - 解决方案：...
  - [查看详情](链接)

### Hacker News（最近7天热门）

1. **讨论标题**（234 points, 89 comments, 2025-10-12）
   - 核心观点：...
   - 社区反馈：...
   - [参与讨论](链接)

### Reddit（最近7天热门）

1. **帖子标题**（67 upvotes, 23 comments, 2025-10-11）
   - 主要内容：...
   - 实用技巧：...
   - [参与讨论](链接)

---

## 📊 本次统计
- 新文章：X 篇
- 更新文章：X 篇
- 新 Issue：X 个
- 热门讨论：X 个
- 已解决问题：X 个

---

📅 生成时间：2025-10-13 16:30
🔄 下次更新：2025-10-14 09:00
```

## 🔄 运行流程

### 第一次运行（初始化）
1. 爬取所有数据源
2. 创建完整的缓存文件
3. 生成完整的报告
4. 更新 baseline.json

### 后续运行（增量更新）
1. **加载缓存**：读取 cache/*.json
2. **检测变化**：
   - 官方：对比版本号
   - 社区文章：对比 URL 列表和更新时间
   - 社区讨论：按时间范围过滤
3. **仅爬取变化内容**：
   - 新版本的更新日志
   - 新文章的详细内容
   - 最近几天的讨论
4. **生成精简报告**：
   - 跳过未变化内容
   - 突出新内容和变化
5. **更新缓存**：
   - 追加新数据
   - 更新时间戳
   - 标记变化状态

## 🎨 视觉标识

- 🆕 新内容
- 🔄 更新内容
- 🔥 热门（高互动）
- 🔴 紧急问题
- ✅ 已解决
- 💬 讨论中
- 📚 文档
- 💡 技巧
- ⚡ 性能
- 🐛 Bug

## 🚀 实现优先级

### Phase 1: 基础增量更新（当前）
- [x] 配置文件优化
- [x] 缓存目录结构
- [ ] 版本变化检测
- [ ] 基础缓存逻辑

### Phase 2: 文章追踪（核心）
- [ ] 社区文档站爬取
- [ ] 文章时间提取
- [ ] 新文章检测
- [ ] 文章摘要生成

### Phase 3: 社区动态（核心）
- [ ] GitHub Issues 时间过滤
- [ ] HN/Reddit 搜索优化
- [ ] 热度排序
- [ ] 内容摘要

### Phase 4: 输出优化
- [ ] 精简报告模板
- [ ] 变化突出显示
- [ ] 快速浏览模式
- [ ] 详细模式切换

## 💡 使用建议

### 每日快速浏览（5分钟）
1. 查看"今日要点"（3句话）
2. 浏览"新文章"列表
3. 扫描"社区核心动态"标题

### 深度了解（15分钟）
1. 阅读新文章摘要
2. 点击感兴趣的文章链接
3. 查看热门讨论详情

### 完整学习（1小时）
1. 逐篇阅读新文章
2. 参与社区讨论
3. 尝试新功能和技巧

---

📝 **注意**：本指南持续更新，根据实际使用情况优化。
